[workspace]
# åŸºç¡€é…ç½®
allow_dirty = false
changelog_update = true
dependencies_update = true
git_release_enable = true
git_tag_enable = true
# ä¸å‘å¸ƒåˆ° crates.io
publish = false

# PR é…ç½® (è™½ç„¶ä¸»è¦ç”± release-pr å‘½ä»¤æ§åˆ¶ï¼Œä½†è¿™é‡Œè®¾ç½®é»˜è®¤å€¼)
pr_draft = false
pr_labels = ["release"]
pr_branch_prefix = "release-plz-"

[changelog]
header = """
# Changelog

All notable changes to this project will be documented in this file.
"""

body = """
{% for group, commits in commits | group_by(attribute="group") %}
## {{ group | upper_first }}
{% for commit in commits %}
- {{ commit.message | split(pat="\n") | first | trim }} ([{{ commit.id | truncate(length=7, end="") }}](https://github.com/{{ remote.owner }}/{{ remote.repo }}/commit/{{ commit.id }}))
{%- endfor %}
{% endfor %}

{% if remote.contributors %}
### Contributors
{% for contributor in remote.contributors %}
* @{{ contributor.username }}
{% endfor %}
{% endif %}
"""

# ä½¿ç”¨ä¸ä½ å‚è€ƒæ–‡ä»¶ä¸­ä¸€è‡´çš„åˆ†ç±»é€»è¾‘
# ç¨å¾®è°ƒæ•´äº†é¡ºåºï¼Œè®© Features å’Œ Fixes æ’åœ¨å‰é¢
commit_parsers = [
    { message = "^feat", group = "ğŸš€ Features" },
    { message = "^fix", group = "ğŸ› Bug Fixes" },
    { message = "^perf", group = "âš¡ Performance" },
    { message = "^refactor", group = "â™»ï¸ Refactor" },
    { message = "^doc", group = "ğŸ“š Documentation" },
    { message = "^test", group = "âœ… Tests" },
    { message = "^ci", group = "ğŸ‘· CI" },
    { message = "^chore", group = "ğŸ”§ Chore" },
    { message = "^build", group = "ğŸ“¦ Build" },
    { message = ".*", group = "Other" },
]

# å¿½ç•¥ä¸éœ€è¦å‡ºç°åœ¨ changelog ä¸­çš„æäº¤
filter_commits = true
commit_preprocessors = [
    # å°† (#123) è½¬æ¢ä¸ºé“¾æ¥
    { pattern = "\\(#([0-9]+))", replace = "([#${1}](https://github.com/{{ remote.owner }}/{{ remote.repo }}/pull/${1}))" },
]
